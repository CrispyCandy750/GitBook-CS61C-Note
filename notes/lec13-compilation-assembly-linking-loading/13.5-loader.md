---
description: 本节内容：1.；2.；3.；
---

# 13.5-Loader

{% embed url="https://youtu.be/E9zh8pobPNw?si=-EifFcStKFBbHoYu" %}
Lecture Video Address
{% endembed %}

## Where Are We Now?

![image-20240609095224384](.image/image-20240609095224384.png)

## Loader Basics

Input: Executable Code (e.g., `a.out` for RISC-V)

Output: (program is run)

Executable files are stored on disk

When one is run, loader’s job is to load it into memory and start it running

In reality, loader is the operating system (OS)

- Loading is one of the OS tasks

## Loader … What Does It Do?

1. Reads executable file’s header to determine size of text and data segments

2. Creates new address space for program large enough to hold text and data segments, along with a stack segment

3. Copies instructions + data from executable file into the new address space

4. Copies arguments passed to the program onto the stack

5. Initializes machine registers

    - Most registers cleared, but stack pointer assigned address of 1st free stack location

6. Jumps to start-up routine that copies program’s arguments from stack to registers & sets the PC

    - If main routine returns, start-up routine terminates program with exit system call

    
